%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Contents: Things you need to know
% $Id: chapter01.tex,v 1.1 2008/05/07 06:59:43 hanqi Exp $
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\chapter{Things You Need to Know}
\chapter{概~述}\label{chap_01}
程序设计语言是人类与计算机交流的语言，在计算机出现的半个多世纪里，先后出现了机器
语言、汇编程序设计语言和高级程序设计语言，
%\footnote{有人在高级程序设计语言之后又加
%  上了数据库管理语言、网络数据交换语言等新的类别，但是笔者认为这些新增的语言还是
%  可以归为高级语言的。}
而真正推动计算机技术和整个信息产业飞速发展的是高级程序
设计语言，它使得编程的门槛大大降低、编程的效率大大提高，才使得众多
天才程序员有了方便高效的工具，打造出了众多改变世界的软件。

从Fortran到Java、Ruby，高级程序设计语言经历了近半个世纪的演化，各种高级程序设计语
言自20世纪60年代以来你方唱罢我登场，上演了一场精彩的语言进化大戏。就像生物界在不
同时代有不同的主宰物种一样，每个年代都有一些最热门的高级程序设计语言，C语言算得
上是20世纪70年代直到80年代最流行的高级程序设计语言\footnote{有人将C称为中级语
  言(比如《The Complete Reference C》的作者Schildt, H.)，意在强调C语言的灵活性，
  但是作者认为不妨以高级语言统一包含所谓的“中级语言”和“数据库管理语言”等“更”
  高级语言，至少在学习程序设计的阶段，不必太过关心这些问题。}，但不是昙花一现式
的流行，事实上，直到现在
C语言仍然是众多程序员首选的程序设计语言，只是由于C++、Java等一些新兴的语言吸
引了很多人的眼球，使得C语言受关注的程度降低而已。但由于C语言与Unix操作系统家族天
生的血缘关系，C语言具备了其他任何程序设计语言所无法企及的强大生命力，C99标准的制
定再一次把C语言推到了程序设计语言开发的前沿，使C语言更加具有其他语言无法比拟的魅
力。

本章将对C语言的历史和特点、以及本书关注的Unix操作系统和MIPS架构的龙芯处理器做
简要介绍，同时介绍中科龙梦生产的龙芯福珑电脑及使用，目的是使读者在开始学习C语言程
序设计之前就可以了解相关的背景知识、初步掌握开发环境的使用。

\section{C语言历史}
计算机从发明到现在始终只能认识0和1，而程序语言设计者们则不断设计出更加接近人
类自然语言的计算机程序设计语言来提高程序员的工作效率。汇编语言就是这种努力的第一
次成功，汇编语言用一些容易记忆的字符或字符串串来代替由0、1序列表示的命令，通过一
个叫汇编器的程序将字符翻译成0、1代码后，程序就可以在计算机上运行了。汇编语言使得
程序具备了一定的可读性，但是汇编语言的程序结构依然和机器语言一样，进行一次最简单
的加法运算都要对CPU的寄存器进行若干次操作。于是，汇编语言中出现了宏的概念，宏是
将一些常见的基本操作组合在一起，得到一个功能更加强大的命令，从而在一定程度上简化
了程序。但是，汇编语言是依赖于计算机的硬件结构，毕竟它直接操纵的是寄存器之类的东
西。于是研制出一台新的计算机，就必须同时开发一个与之相适应的汇编语言版本。

这种状况直到1954年Fortran语言的问世才出现转机，Fortran是世界上第一种脱离机器硬件
的高级语言，之后的40多年里，有数百种高级语言被许多天才的程序员发明，有数十种在激
烈的竞争中站稳了脚跟，生存了下来。二十世纪60年代，一场“软件危机”促生了第一种结
构化程序设计语言--Pascal，它是在1969年提出结构化程序设计方法之后的1970年产生的。
如今，这两种语言还在广泛的应用，Fortran仍然是科学和工程计算领域里重量级的语言，
积累了大量有价值的代码，而基于Pascal语言的Delphi曾是VB最有力的竞争者。

%可见，
悠久的历史只能说明一种编程语言强大的生命力，并不代表过时或者没落。C语言的
历史同样证明了这个道理，C语言是由Dennis Ritchie于二十世纪70年代初发明的，当时
Unix的设计者Ken Thompson改进了早期的计算机语言BCPL，将其压缩到了8k bytes的内存中，
得到了B语言，而C语言则是在B语言的基础上发展而来，从名字似乎可以看出这三者之间的
关系。C语言之所以后来名声大噪，归功于贝尔实验室和Unix系统，因为从1973年C语言第一
次用来编写Unix内核依赖，直到现在的Linux等Unix家族新成员一直使用C语言来编写系统的
内核。当然，C语言有如此地位并不是靠运气，因为B语言也曾经用来编写系统。

C语言并不是一成不变的，在30多年的历史中，C语言经有过三种的版本。
\begin{itemize}
\item \textbf{K\&{}R C:} 1978年，Brian Kernighan和Dennis Ritchige合著了《C语言程
  序设计》一书，在以后相当长一段时间内成为C语言事实上的规范。但这并不是一个严格
  的标准，因此尽管多数C语言系统接受的源程序都能高度兼容，但是仍然存在一些差异。
\item \textbf{ANSI C (C89):} 1983年初夏，ANSI(美国国家标准协会)成立了一个委员会
  制定统一的C语言标准，但是却花了超乎想像的6年时间，于1989年完成。随后ISO(国际标
  准化组织)也采用了这个标准，因此C89标准一般称为ANSI/ISO Standard C。
\item \textbf{C99:} 进入90年代，人们都在忙于学习C++，为C++制定标准，似乎遗忘了C
  语言，但是C语言并没有停滞不前，1999年，C99标准在人们对Java、C++的追捧中制问世
  了，正如《C The Complete Reference》的作者该书第4版中所说的，“在历史的洪流
  中，人们很容易只注意那些新的事物，而忽视了用以构筑未来坚实基础”。C99相对C89增
  加了一些特性，比如增加了一些新的关键字、增加了对变长数组的支持、增加了对复数的
  支持等，删除了“隐含的int”规则、隐含的函数声明等特性，另外对转换限制、整数类
  型等特性进行了修改。尽管如此，C89于C99的差别并不像一些人想像的那么大，一个熟悉
  C89的程序员只需稍微查一下资料就可以顺利的继续他的工作。
\end{itemize}

\begin{CJK}{GBK}{kai}
值得注意的一点是，C89是通常所说的C++的C子集，也是C99的基础，但是C99并不是C++的子
集。因此，如果想编写可以被C++编译程序编译的C程序，或者打算有朝一日移植将自己的C
程序到C++环境中，了解C89和C99的差别是非常必要的。
\end{CJK}

\section{C语言的特点}
相比其他的编程语言，C语言有一些非常突出的特点，这些特点不能简单的用优点和缺点来
形容，C语言的一些特性或许是一些人的噩梦，但确是熟练程序员的福音(如指针)。所以这
里只是把这些特性列出，相信随着学习的深入读者会对C语言的这些特性有自己的理解。

\begin{itemize}
\item \begin{CJK}{GBK}{hei}位操作：\end{CJK} 也许正是C语言的这个特点使得很多人把
  C语言称为“中级语言”，C语言可以象汇编语言一样对位、字节和地址进行操作，而这三
  者是计算机最基本的工作单元。
\item \begin{CJK}{GBK}{hei}结构式语言：\end{CJK}C语言是一种结构式语言，其显著特
  点是代码和数据的分隔，程序的各个部分除了必要的信息交流外彼此独立，这使得程序层
  次清晰、便于维护和调试。通过各个功能函数的调用，配合循环、条件等语句控制程序流
  向，从而使程序完全结构化。
\item \begin{CJK}{GBK}{hei}高效性：\end{CJK}C是一种相当高效的语言，C语言程序往往
  非常紧凑、简洁，并且运行速度非常快，在设计上充分利用了当前计算机在能力上的优点，
  往往表现出通常只有汇编语言才具有的精细控制能力，你甚至可以精细的调节程序在速度
  和内存使用率之间的平衡。
\item \begin{CJK}{GBK}{hei}可移植性：\end{CJK}C语言的可移植性与Java的可移植性不
  可相提并论，事实上，可移植性存在于硬件平台、源代码直到二进制
  代码等多个层次上。C语言的可移植性在于源代码层次，编译后的C程序并不能很容易的运
  行在其他平台上。但是由于C编译器在从8位微处理器到超级计算机等几乎所有类型系统上
  都有实现，一个系统上编写的C语言程序不须修改或者经过很少修改就可以在其他系统上
  重新编译运行。从这个意义上讲，C语言的可移植性在于这种语言的本身，而不在于其运
  行环境或者虚拟机之类。C的这种特性受益于其悠久的历史以及与Unix的密切联系，当然
  最根本的原因还在于语言本身的优点被不同应用场合的用户所接受并喜爱。
\item \hei 强大而灵活：\song C语言的强大和灵活已经不用过多解释，没有几种语言能够
  成功的被用来编写操作系统，而能够写出同样功能强大的Unix操作系统，更印证了C语言
  的这一特点。不仅是操作系统，其他编程语言如Fortran、Perl、Basic、Python等的许多
  编译器和解释器也都是用C语言编写的，C语言也渐渐开始取代Fortran在科学和工程计算
  领域中的地位，而用来制造电影特效、三维游戏等的工具也有很多采用C语言编写。
\item \hei 面向程序员：\song C是一种面向程序员的语言。C语言会尽可能少的限
  制程序员的行为，允许程序员按照自己的意愿访问硬件、操纵内存；C语言提供了丰富的
  运算符共选择，让程序员能够简洁的表达自己的意图\dots C语言给程序员最大的灵活性
  和发挥想像力的空间，当然，这种灵活性也是一种潜在的危险。
\item \hei 丰富的库： \song 大多数情况下，开发C语言程序并不需要从头开始处理所有
  的问题，很多程序员前辈已经通过库把他们的聪明才智积累了下来，我们只需要根据需求
  寻找合适的函数。并且，很多优秀的库都是免费的，特别是在Linux/Unix环境下，几乎所
  有的库都遵循类似GNU这样的开源协议。
\end{itemize}

从事物两面性的角度看待C语言的这些特点，也许有的特点会被认为是缺点。比如C语言在表
达方面的自由，这种自由会增加程序的风险，可能会导致一些难以发现的编程错误，正如专
家所言：自由的代价是永远的警惕。C语言丰富的运算符也可能导致及其晦涩难懂的代码的
产生，严重降低代码的可读性。也许每个人对C语言的特点都有自己的理解，这不要紧，C语
言本来就不是为了参加优点竞赛而设计的。

\section{Unix与C语言}
1969年Dennis Ritchie和Ken Thompson在贝尔实验室创造性地发明了Unix操作系统，为此
1983年他们获得了图灵奖。这个伟大的操作系统的诞生在当时看起来更像是计算机天才们的
游戏，在不经意之间就成就了一个改变历史的发明。

1965年时，贝尔实验室、General Electric公司和麻省理工学院(MIT)计划合作开发一套多
用户、多任务、多层次的操作系统，称为MULTICS(MULTiplexed Information and
Computing System--多路信息与计算系统)计划。到了1969年，因MULTICS计划的工作
进度太慢，该计划就被停了下来。当时，Ken Thompson已经有一个称为“星际旅行”的程序
在GE-635的机器上跑，但是反应非常的慢，正巧也被他发现了一部被闲置的PDP-7，于是Ken
Thompson和Dernis Ritchie就打算将“星际旅行”的程序移植到PDP-7上，而PDP-7上没有程
序开发环境，于是他们俩为了支持游戏开发而在PDP-7上编写了成为Unix核心的实用程序，
而这部本来用做一台“真正”的计算机的图形终端的PDP-7就此在整个计算机历史上留下了
芳名。

1971年，Dennis Ritchie和Ken Thompson以“文字处理”程序的名义申请了一部PDP-11，这
是一种比PDP-7功能强大的多的小型机。在这台机器上，他们开发出了第一个Unix程序，也
就是文本格式化程序(nroff/troff)的前身。贝尔实验室的专利部门采用了这套系统作为他
们处理文件的工具，而贝尔实验室的专利部门也就成为Unix的第一个正式使用者。

随着1973年两位作者的第一篇关于Unix的论文以及向学术界免费提供源代码\footnote{贝尔
  实验室的母公司AT\&{}T在1958年的一个和解协议中被禁止进入计算机相关的商业领域，因
  此Unix不能做为商品出卖，根据协议，贝尔实验室必须将非电话业务的技术许可给任何提
  出要求的人。}的行为造成了
Unix在学术界的广为流传，才引出了后来的商业化、BSD版权诉讼、GNU/Linux的兴起等一个
又一个的故事，Unix的故事到此为之，该回过头来谈谈C语言了。

最初在PDP-7上编写Unix用的是汇编语言和B语言，B语言是一种解释型语言，优点是非常小
巧，以至于可以在PDP-7上运行，但是做为系统编程语言还显得不够强大，于是Dennis
Ritchie给它增加了数据类型和结构。1971年，从B语言进化出了C语言。1973年，Ken
Thompson和Dennis Ritchie用C语言重写了整个Unix系统，第一次为操作系统带来了可移植
性，这也为Unix的广泛流传提供了技术上的保证。Unix的后裔们也都继承了这个做法，用C
语言做为系统开发的语言。于是，C语言和Unix(包括其它Unix类系统)就以这样一种相互依
存、相互促进的方式共同创造了计算机史上的奇迹。

严格来讲，现在已经没有哪个Unix类的操作系统叫Unix了，目前“UNIX”这个商
标目前属于一个叫“Open Group”的组织，不过数十年年来，这个标识已经被冲淡到没有具体
含义了，许多运行Solaris、HP-UX、FreeBSD、Linux等类似Unix系统的人都认为他们运行的
是Unix，这些系统通常被认为属于一类----不论是书中、媒介、网上还是社会公认。按照
Unix FAQ的定义，Unix是“一个用C语言编写的操作系统，它有层次文件系统并集成了文件
和设备I/O，其系统调用接口包括fork()和pipe()等服务，用户界面包括cc、troff、grep、
awk等工具和一个被选择的shell”。可以再加一些，UNIX为多任务提供一致的方式，并内置
有创建、同步和终止进程的操作，它可在不同种类计算机间进行移植。从这个意义上讲，
Linux也是一种Unix，至少是一个完整的Unix克隆。本书的上机实验将在Debian Linux上进
行，这是一个老牌的、有着先进的包管理机制的Linux发行版，同时也是号称最自由的一个
Linux发行版。

\section{龙芯福珑电脑简介}
龙芯福珑电脑是由江苏中科龙梦科技有限公司生产的迷你型计算机，该计算机采用了我国自
主研发的龙芯2E处理器，整机具有低功耗、高性能、移动便携、廉价实用等特点，是一款低
功耗高性能PC机。它采用了笔记本技术，使得整个机箱仅有普通DVD光驱大小，机身轻巧精
致，携带方便，操作系统采用了开源可定制的Debian Linux操作系统。，可广泛适合于个人
及政府办公、教育、家庭媒体中心、高端机顶盒、多媒体电子教室、酒店信息化、多媒体信
息亭等桌面计算领域以及工控等嵌入式领域。
本书写作的动机在于推动龙芯电脑在教育领域的应用，因此在实践环节上完全面向龙芯福珑
电脑，对于在Debian Linux系统下C语言的开发方法给予了详细的介绍，目的是希望读者通
过本书的学习，既能达到高校C语言课程的教学目标，又能掌握Linux系统下C语言开发的技
能。

虽然龙芯福珑电脑的外观很独特，但是它的使用与普通电脑并没有太大的差别。一台完整的
福珑电脑由主机\footnote{很多网友将这种小巧的龙芯电脑称为龙芯盒子}、显示器、键盘、
鼠标及其他外设。在性能上，福珑电脑目前采用龙芯2E处理器，相当于中档奔腾四处理器的
水平，使用Gnome窗口系统的感觉相当流畅，非常适合做为基于Linux的计算机类课程学习平
台。

龙芯福珑电脑上预装的是Debian Linux系统，按下开机按钮后，系统会自动进入图形登录界
面，输入用户名和密码即可进入基于Gnome图形系统的桌面，如图\ref{fig_1_1}。
\begin{figure}
\centering
\includegraphics[width=3.5in]{./figures/chap01/debiandesk}
\caption{福珑电脑的桌面}
\label{fig_1_1}
\end{figure}

\section{一个具体而微的例子}\label{example_1-1}
下面是一个简单的例子，可以展示在龙芯福珑电脑上编写最基本的C语言程序的过程。
在Debian Linux的图形界面中，有很多操作可以用鼠标点击代替命令行操作，但是我们以为
学习Linux还是不要回避命令，因此下面我们将展示的是基于命令行和文本编辑器的C语言上
机实验的操作方法。

首先，点击上部工具条的终端图标打开虚拟终端，如图\ref{fig_1_2}
所示。
\begin{figure}
\centering
\includegraphics[width=3.5in]{./figures/chap01/term}
\caption{虚拟终端窗口}
\label{fig_1_2}
\end{figure}
做为程序员的良好习惯之一，保持文件的整洁有序是非常重要的，因此我们建议把每一个程
序放在各自不同的目录里。这里我们建立一个名为gspro01的目录(命令：\verb=mkdir gspro01=)，然后通过\verb=cd gspro01=命令进入目录，运行文本编辑软件建立源程序文件，
我们推荐gedit和emacs这两个软件\footnote{gedit是Gnome窗口系统自带的文本编辑器，
  而emacs是一个著名的编辑器，以功能强大和稳定著称，Debian系统的默认安装中没有emacs，
  可以通过apt-get install emacs命令安装(当然，这需要管理员权限)。}，如图
\ref{fig_1_3}和\ref{fig_1_4}所示。
\begin{figure}
\centering
\includegraphics[width=3.5in]{./figures/chap01/gedit-pro}
\caption{用gedit编写程序}
\label{fig_1_3}
\end{figure}
\begin{figure}
\centering
\includegraphics[width=3.5in]{./figures/chap01/emacs-pro}
\caption{用emacs编写程序}
\label{fig_1_4}
\end{figure}

在文本编辑器中输入如下一段代码，并保存成名为pro01.c的C源文件。

\begin{minipage}[c]{8cm}
\begin{verbatim}
#include <stdio.h>

int main()
{
    int height = 15;
    int width = 12;
    int area;

    area = height * width;
    printf("The height is %d, the width is %d.\n",
                height, width);
    printf("And the area is : %d \n", area);

    return 0;
}
\end{verbatim}
\end{minipage}

然后在命令行用gcc编译，命令是\verb=gcc pro01.c -o pro01=，注意Linux系统默认bash
shell\footnote{shell就是终端中所看到的命令行背后的程序，可以简单的把它理解成一个
  命令解释器，它是Unix类系统重要的组成部分，是用户和操作系统的界面，负责接收、执
  行用户的命令并显示操作系统的反馈。shell程序有很多中，bash是Linux系统中默认的的
  shell，更多关于shell的知识请参考相关书籍。}支持自动补齐，比如\verb=pro01.c=这
个文件名你只需要打出字母\verb=p=然后按TAB键，shell就会去寻找以p开头的文件，如果
有且仅有一个这样的文件，它会自动将整个文件名显示出来(如果有多个呢？当然是列出来
供你选择喽)。

用\verb=ls=命令可以列出当前目录下的文件，可以看到编译之后目录下多了一个叫pro01的
文件，用命令\verb=.pro01=运行它，就看到了上面程序中希望看到的结果(图\ref{fig_1_5})。
\begin{figure}
\centering
\includegraphics[width=3.5in]{./figures/chap01/runpro}
\caption{编译并运行C语言程序}
\label{fig_1_5}
\end{figure}

\begin{CJK}{GBK}{kai}
通过上面的例子我们可以学到几个基本的Linux命令：
\begin{itemize}
\item ls  列出当前目录下的文件，试试看加上\verb=-l=、\verb=-a=这样的参数
  会出现什么样的结果？
\item cd 进入目录，后面的参数是要进入的目录名，例如 \verb=cd gspro01=；
\item mkdir 创建目录，后面的参数是要创建的目录名，例如 \verb=mkdir gspro01=；
\end{itemize}
\end{CJK}

\section{小结}
本章介绍了C语言的历史及特点，并讲述了Unix与C语言的渊源，通过这些介绍，相信读者已
经对C语言的身世背景有了一个大概的了解，希望C语言历史的辉煌和魅力能够吸引你继续深
入学习。本章给出了一个简单的例子，虽然很简单，但是通过这个例子读者可以大概体验一
下Unix程序员的工作方式，和Windows下动辄就是一个庞大的集成开发环境(IDE)相比，Unix
程序员的编程方式更加简练而深入，使用MS-VC编程，有可能用了很久还不知道源文件、目
标文件、可执行文件的关系，而Unix程序员在一开始就要了解程序代码是如何变成计算机可
以运行的01代码的。

本书是专为龙芯福珑电脑而编写，但本书所讲述的内容并不仅仅适用于龙芯福珑电脑，事实
上，本书更像是一本基于Linux系统及其程序开发环境的C语言教程，因为运行与龙芯福珑电
脑的Debian Linux与运行于其它电脑上的Debian
Linux在使用和功能上并没有太大差别。

下一章将介绍C语言的基本元素：数据类型、运算符与表达式，这些元素是一种程序设计语
言的基础。

\section{习题与上机作业}
\subsection{习题}
\begin{enumerate}
\item 简单介绍一下C语言的历史？
\item 把C语言和Unix的历史当做故事讲给你的朋友听。
\item 龙芯福珑电脑有什么特点？
\item 上网查找更多关于龙芯的知识，谈谈你对龙芯以及其他国产CPU的看法？
\item 按照\ref{example_1-1}节的示例，在一台龙芯福珑电脑或者其他装有Unix类操作系统
  的电脑上体验一下Unix编程。
\end{enumerate}

\subsection{上机作业}
\begin{enumerate}
\item
在福珑电脑上输入并运行本章的示例程序，熟悉在福隆电脑上进行C语言程序开发的过程。
\end{enumerate}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "~/now-working/document/opensource/godsonCguide/main"
%%% End:
